\newcommand\hmmax{0}
\newcommand\bmmax{0}

\usepackage{amsthm}
\usepackage{bm}
\usepackage{dsfont}
\usepackage{thm-restate}
\usepackage{centernot}

\DeclareFontFamily{U}{matha}{\hyphenchar\font45}
\DeclareFontShape{U}{matha}{m}{n}{ <-6> matha5 <6-7> matha6 <7-8>
matha7 <8-9> matha8 <9-10> matha9 <10-12> matha10 <12-> matha12 }{}
\DeclareSymbolFont{matha}{U}{matha}{m}{n}
%
\DeclareFontFamily{U}{mathx}{\hyphenchar\font45}
\DeclareFontShape{U}{mathx}{m}{n}{ <-6> mathx5 <6-7> mathx6 <7-8>
mathx7 <8-9> mathx8 <9-10> mathx9 <10-12> mathx10 <12-> mathx12 }{}
\DeclareSymbolFont{mathx}{U}{mathx}{m}{n}

\DeclareMathDelimiter{\liv} {4}{matha}{"76}{mathx}{"30}
\DeclareMathDelimiter{\riv} {5}{matha}{"77}{mathx}{"38}

\usetikzlibrary{shapes,arrows,positioning,fit,circuits.logic.US,math,shapes.geometric}

\newcommand{\bigo}{\mathcal{O}}
\newcommand{\set}[1]{\mathbf{#1}}
\DeclareMathOperator*{\argmin}{\normalfont{arg\,min}}
\DeclareMathOperator*{\argmax}{\normalfont{arg\,max}}
\DeclareMathOperator*{\Val}{\normalfont{Val}}
\DeclareMathOperator*{\Ch}{\normalfont{Ch}}
\DeclareMathOperator*{\Desc}{\normalfont{Desc}}
\DeclareMathOperator*{\Pa}{\normalfont{Pa}}
\DeclareMathOperator*{\Sc}{\normalfont{Sc}}
\DeclareMathOperator*{\Root}{\normalfont{Root}}
\DeclareMathOperator{\Sum}{\textsf{S}}
\DeclareMathOperator{\Sums}{\textsf{\textbf{S}}}
\DeclareMathOperator{\Prod}{\textsf{P}}
\DeclareMathOperator{\Prods}{\textsf{\textbf{P}}}
\DeclareMathOperator{\Leaf}{\textsf{L}}
\DeclareMathOperator{\Leaves}{\textsf{\textbf{L}}}
\DeclareMathOperator{\Node}{\textsf{N}}
\DeclareMathOperator{\Nodes}{\textsf{\textbf{N}}}
\DeclareMathOperator{\Child}{\textsf{C}}
\DeclareMathOperator{\Children}{\textsf{\textbf{C}}}
\DeclareMathOperator{\Conj}{\otimes}
\DeclareMathOperator{\Disj}{\oplus}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\defeq}{\vcentcolon=}
\DeclareMathOperator*{\ind}{\mathds{1}}
\DeclareMathOperator*{\True}{\normalfont{true}}
\DeclareMathOperator*{\False}{\normalfont{false}}
\DeclareMathOperator{\vtree}{\mathcal{V}}
\DeclareMathOperator{\Forget}{\normalfont{Forget}}
\DeclareMathOperator{\mutualinf}{\normalfont{MI}}
\DeclareMathOperator{\pairmi}{\normalfont{pMI}}
\newcommand{\sspace}[1]{\bm{\mathcal{#1}}}
\newcommand{\lch}[1]{#1^\gets}
\newcommand{\rch}[1]{#1^\to}

\newcommand{\divclass}{\texttt{DIV}}
\newcommand{\incrclass}{\texttt{INCR}}
\newcommand{\randclass}{\texttt{RAND}}

\newcommand{\evi}{\textsf{EVI}}
\newcommand{\mar}{\textsf{MAR}}
\newcommand{\map}{\textsf{MAP}}
\newcommand{\con}{\textsf{CON}}
\newcommand{\mi}{\textsf{MI}}
\newcommand{\ce}{\textsf{CE}}
\newcommand{\expc}{\textsf{EXP}}

\newcommand\indep{\protect\mathpalette{\protect\independenT}{\perp}}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern2mu{#1#2}}}
\newcommand\notindep{\centernot{\indep}}

\newcommand{\edge}[1]{\overrightarrow{#1}}

\newcommand{\ov}{\overline}
\newcommand{\tsup}{\textsuperscript}
\newcommand{\newGraphNode}[4]{\node[#4] (#1) at (#2) {\rotatebox{-90}{#3}}}
\newcommand{\newNamedAndNode}[4][]{\node[#1,and gate,fill=blue!50!red!30,inner sep=0pt,scale=0.75,minimum size=12pt,thick,point up,#1] (#2) at (#3) {\rotatebox{-90}{#4}}}
\newcommand{\newNamedOrNode}[4][]{\node[#1,or gate,fill=blue!50!green!30,inner sep=0pt,scale=0.75,minimum size=12pt,thick,point up,#1] (#2) at (#3) {\rotatebox{-90}{#4}}}
\newcommand{\newAndNode}[3][]{\node[#1,and gate,fill=blue!50!red!30,thick,inner sep=0pt,scale=0.75,minimum size=12pt,point up,#1] (#2) at (#3) {}}
\newcommand{\newOrNode}[3][]{\node[#1,or gate,fill=blue!50!green!30,thick,inner sep=0pt,scale=0.75,minimum size=12pt,point up,#1] (#2) at (#3) {}}
\tikzset{circuit logic US}

\newcommand{\newSumNode}[3][]{\node[circle,draw,inner sep=0pt,minimum size=12pt,thick,fill=blue!50!green!30,#1] (#2) at (#3) {$\bm{+}$}}
\newcommand{\newMixNode}[3][]{\node[#1,circle,draw,inner sep=0pt,minimum size=12pt,thick,fill=blue!50!green!30] (#2) at (#3) {$\sum$}}
\newcommand{\newProdNode}[3][]{\node[circle,draw,inner sep=0pt,minimum size=12pt,thick,fill=blue!50!red!30,#1] (#2) at (#3) {$\bm{\times}$}}
\newcommand{\newLeafNode}[3][]{\node[circle,draw,inner sep=0pt,minimum size=12pt,thick,fill=orange!50!black!40,#1] (#2) at (#3) {$\bm{\bigcirc}$}}
\newcommand{\newCellNode}[3][]{\node[#1,circle,draw,inner sep=0pt,minimum size=12pt,thick,fill=orange!50!black!40] (#2) at (#3) {$\bm{\Box}$}}
\tikzset{sigmoid/.style={path picture={\begin{scope}[x=0.65pt,y=7pt] \draw plot[domain=-6:6](\x,{1/(1+exp(-1.5*\x))-0.5}); \end{scope}}}}
\tikzset{gaussian/.style={path picture={\begin{scope}[x=1pt,y=10pt] \draw plot[domain=-4:4](\x,{exp(-\x*\x*0.5)/2.5-0.1}); \end{scope}}}}
\newcommand{\newProjNode}[3][]{\node[#1,sigmoid,circle,draw,inner sep=2pt,minimum size=13pt,thick,fill=blue!50!green!30] (#2) at (#3) {};}
\newcommand{\newGaussNode}[3][]{\node[gaussian,circle,draw,inner sep=2pt,minimum size=13pt,thick,fill=orange!50!black!40,#1] (#2) at (#3) {};}
\newcommand{\newPartNode}[3][]{\node[#1,circle split,rotate=90,draw,inner sep=2pt,minimum size=12pt,thick,fill=blue!50!red!30] (#2) at (#3) {};}
\newcommand{\inode}[2][]{\tikz[baseline=-0.75ex]{#2[scale=0.8,#1]{r}{0,0};}}

\newcommand{\newVtreeNode}[3]{\node[inner sep=2pt,minimum size=13pt] (#1) at (#2) {#3}}

\usepgfplotslibrary{fillbetween}
\pgfmathdeclarefunction{gauss}{2}{%
  \pgfmathparse{1/(#2*2.5066)*exp(-((x-#1)^2)/(2*#2^2))}%
}
\pgfmathdeclarefunction{egauss}{3}{%
  \pgfmathparse{1/(#2*2.5066)*exp(-((#3-#1)^2)/(2*#2^2))}%
}
\pgfmathdeclarefunction{gauss3}{6}{%
  \pgfmathparse{(exp(-((x-#1)^2)/(2*#2^2))/#2+exp(-((x-#3)^2)/(2*#4^2))/#4+exp(-((x-#5)^2)/(2*#6^2))/#6)/2.5066}%
}
\pgfmathdeclarefunction{mixgauss3}{9}{%
  \pgfmathparse{(#7*exp(-((x-#1)^2)/(2*#2^2))/#2+#8*exp(-((x-#3)^2)/(2*#4^2))/#4+#9*exp(-((x-#5)^2)/(2*#6^2))/#6)/2.5066}%
}
\pgfmathdeclarefunction{mixgauss2}{6}{%
  \pgfmathparse{(#5*exp(-((x-#1)^2)/(2*#2^2))/#2+#6*exp(-((x-#3)^2)/(2*#4^2))/#4)/2.5066}%
}
\pgfmathdeclarefunction{mixgauss2y}{6}{%
  \pgfmathparse{(#5*exp(-((y-#1)^2)/(2*#2^2))/#2+#6*exp(-((y-#3)^2)/(2*#4^2))/#4)/2.5066}%
}

\DeclareMathOperator{\gaussian}{\mathcal{N}}
\newcommand*\dif{\mathop{}\!\mathrm{d}}

\definecolor{LightGray}{gray}{0.85}
\definecolor{Red}{rgb}{0.75,0,0}

\tikzset{
  edge/.style = {->,>=latex'}
}

\newcommand{\drawOldGradient}[3]{%
% #1: starting node
% #2: ending node
% #3: attributes for the shape connecting nodes
\path let
  \p1 = ($(#2)-(#1)$),
  \n1 = {veclen(\p1)},
  \n2 = {atan2(\y1,\x1)} % <- Update
in
  (#1) -- (#2) node[#3,midway,sloped,shading angle=\n2-90,minimum width=\n1,minimum height=0.5pt,inner sep=1pt,#3] {};
}

\newcommand{\drawGradient}[4]{%
% #1: starting node
% #2: ending node
% #3: attributes for the shape connecting nodes
\path let
  \p1 = ($(#2)-(#1)$),
  \n1 = {veclen(\p1)},
  \n2 = {atan2(\y1,\x1)} % <- Update
in
  (#1) -- (#2) node[midway,sloped,shading angle=\n2-90,minimum width=\n1,minimum height=0.5pt,inner sep=1pt,top color=#3,bottom color=#4] {};
}

%\tikzfading[name=fade down,top color=blue!0, bottom color=red!100]
%\tikzfading[name=fade up,top color=red!100, bottom color=blue!0]

%\newcommand{\drawSlowGradient}[4]{
  %\path[path fading=fade down,ultra thick,draw=#3] (#1) -- (#2);
  %\path[path fading=fade up,ultra thick,draw=#4] (#2) -- (#1);
%}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{definition}{Definition}[section]
